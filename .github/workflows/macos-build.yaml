name: macos build
run-name: build runner on macos ğŸš€

# è§¦å‘CIæ¡ä»¶
on:
  push:
    # å½“ä¸‹é¢æ–‡ä»¶å‘ç”Ÿå˜åŒ–æ—¶, è§¦å‘CI
    paths:
      - 'setup.py'
      - 'packages.json'
      - '.github/workflows/macos-build.yaml'

  pull_request:
    branches:
    # å½“ä¸‹é¢åˆ†æ”¯PRæ—¶, è§¦å‘CI
      - main
  
jobs:
  build-amd-macos:
    strategy:
      matrix:
        os: ["macos-latest"]
    runs-on: ${{ matrix.os }}

    # github æä¾›çš„macOSé•œåƒé‡ŒåŒ…å«åŸºæœ¬çš„å¼€å‘å·¥å…·, åŒ…æ‹¬brew python3
    steps:

      - name: Check out repository code
        uses: actions/checkout@v3

      - name: Build
        run: |
          bash -c "cd ${{ github.workspace }} && python3 setup.py && source install/setup.bash"

      - name: Test
        run: |
          bash -c "cd ${{ github.workspace }} && source install/setup.bash"
